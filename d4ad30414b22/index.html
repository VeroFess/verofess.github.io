<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1,minimum-scale=1" name="viewport"><meta content="ie=edge" http-equiv="X-UA-Compatible"><meta content="#fff" name="theme-color" id="theme-color"><meta content="威尔的博客" name="description"><link href="/image/common/apple-touch-icon.png" rel="icon"><title>一些网络安全方面的基础科普 - P1 识别恶意软件</title><meta content="一些网络安全方面的基础科普 - P1 识别恶意软件" property="og:title"><meta content="https://blog.binklac.com/d4ad30414b22/index.html" property="og:url"><meta content="/image/common/avatar.png" property="og:img"><meta content="威尔的博客" property="og:img"><meta content="article" property="og:type"><meta content="2022-11-21" property="og:article:published_time"><meta content="2022-11-22" property="og:article:modified_time"><meta content="VeroFess" property="og:article:author"><meta content="信息安全" property="og:article:tag"><meta content="科普" property="og:article:tag"><link href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css" rel="preload" as="style"><link href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css" rel="preload" as="style"><link href="/css/main.css" rel="preload" as="style"><link href="//instant.page/5.1.0" rel="modulepreload"><link href="/css/main.css" rel="stylesheet"><link href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css" rel="stylesheet"><link href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css" rel="stylesheet"><script>function loadScript(e,t){var n=document.createElement("script");n.src=e,t&&(n.onload=t),n.async=!0,document.body.appendChild(n)}function loadCSS(e,t,n){var a=document.createElement("link");a.ref="stylesheet",a.href=e,a.dataset[t]=n,document.head.appendChild(a)}function changeCSS(e,t,n){var t=document.querySelector(t),a=document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("href",e),a.dataset.prism=n,document.head.replaceChild(a,t)}</script><script>var reverseDarkList={dark:"light",light:"dark"},themeColor={dark:"#1c1c1e",light:"#fff"},getCssMediaQuery=function(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},reverseDarkModeSetting=function(){var e=localStorage.getItem("user-color-scheme");if(reverseDarkList[e])e=reverseDarkList[e];else{if(null!==e)return;e=reverseDarkList[getCssMediaQuery()]}return localStorage.setItem("user-color-scheme",e),e}</script><script>var setDarkmode=function(e){e=e||localStorage.getItem("user-color-scheme");e===getCssMediaQuery()?(document.documentElement.removeAttribute("data-user-color-scheme"),localStorage.removeItem("user-color-scheme"),document.getElementById("theme-color").content=themeColor[e],document.getElementById("theme-color").dataset.mode=e):reverseDarkList[e]?(document.documentElement.setAttribute("data-user-color-scheme",e),document.getElementById("theme-color").content=themeColor[e],document.getElementById("theme-color").dataset.mode=e):(document.documentElement.removeAttribute("data-user-color-scheme"),localStorage.removeItem("user-color-scheme"),document.getElementById("theme-color").content=themeColor[getCssMediaQuery()],document.getElementById("theme-color").dataset.mode=getCssMediaQuery())};setDarkmode()</script><link href="/js/lib/lozad.min.js" rel="preload" as="script"><link href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" rel="prefetch" as="script"><meta content="Hexo 6.3.0" name="generator"><link href="/atom.xml" rel="alternate" title="0xBACB" type="application/atom+xml"></head><body><div class="wrapper"><nav class="navbar"><div class="navbar-logo"><a href="/" class="navbar-logo-main"><img alt="blog logo" class="navbar-logo-img" src="/image/common/apple-touch-icon.png" height="32" width="32"> <span class="navbar-logo-dsc">0xBACB</span></a></div><div class="navbar-menu"><a href="/" class="navbar-menu-item">首页 </a><a href="/archives" class="navbar-menu-item">归档 </a><a href="/tags" class="navbar-menu-item">标签 </a><a href="/categories" class="navbar-menu-item">分类 </a><a href="/about" class="navbar-menu-item">关于 </a><a href="/links" class="navbar-menu-item">友链 </a><button aria-label="Toggle dark mode" class="navbar-menu-item navbar-menu-btn darknavbar" id="dark"><i class="iconfont icon-weather"></i></button> <button aria-label="Toggle search" class="navbar-menu-item navbar-menu-btn searchnavbar" id="search"><!-- <i 
        class="iconfont icon-search" 
        style="font-size: 1.2rem; font-weight: 400;">
      </i> --> <svg aria-hidden="true" class="iconify iconify--ion" height="28" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 512 512" width="28" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 80a176 176 0 1 0 176 176A176 176 0 0 0 256 80Z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28"></path><path d="M232 160a72 72 0 1 0 72 72a72 72 0 0 0-72-72Z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28"></path><path d="M283.64 283.64L336 336" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28" stroke-linecap="round"></path></svg></button></div></nav><div id="local-search" style="display:none"><input class="navbar-menu-item" id="search-input" placeholder="请输入搜索内容..."><div id="search-content"></div></div><div class="section-wrap"><div class="container"><div class="columns"><aside class="left-column"><div class="card card-author"><img alt="author avatar" class="author-img" src="/image/common/avatar.png" height="88" width="88"><p class="author-name">VeroFess</p><p class="author-description">一个通过开发安全工具让系统变得不安全的家伙</p><div class="author-message"><a href="/archives" class="author-posts-count"><span>5</span> <span>文章</span> </a><a href="/categories" class="author-categories-count"><span>3</span> <span>分类</span> </a><a href="/tags" class="author-tags-count"><span>5</span> <span>标签</span></a></div><div class="author-card-society"><div class="author-card-society-icon"><a href="https://github.com/VeroFess" rel="noopener" target="_blank"><i class="iconfont icon-github society-icon"></i></a></div></div></div><div class="sticky-tablet"><article class="display-when-two-columns spacer"><div class="card card-content toc-card"><div class="toc-header"><i class="iconfont icon-menu" style="padding-right:2px"></i>目录</div><ol class="toc"><li class="toc-item toc-level-2"><a href="#01-%E6%89%8B%E6%8A%8A%E6%89%8B%E7%9A%84%E5%85%A5%E9%97%A8-%E6%B5%85%E8%B0%88%E4%B8%80%E4%B8%8B%E6%AF%94%E8%BE%83%E6%B3%9B%E7%94%A8%E7%9A%84%E7%97%85%E6%AF%92-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6-%E8%AF%86%E5%88%AB%E6%96%B9%E5%BC%8F" class="toc-link"><span class="toc-text">01 手把手的入门! 浅谈一下比较泛用的病毒(恶意软件)识别方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#01-1-%E4%B8%87%E4%BA%8B%E5%BC%80%E5%A4%B4%E9%9A%BE-%E8%AF%AF%E6%8A%A5" class="toc-link"><span class="toc-text">01-1 万事开头难: 误报</span></a></li><li class="toc-item toc-level-3"><a href="#01-2-Virus-Total-%E7%AE%80%E5%8D%95%EF%BC%8C%E9%AB%98%E6%95%88%E7%9A%84%E6%81%B6%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90%E8%AF%86%E5%88%AB%E7%BD%91%E7%AB%99" class="toc-link"><span class="toc-text">01-2 Virus Total: 简单，高效的恶意文件分析识别网站</span></a></li><li class="toc-item toc-level-3"><a href="#01-3-%E5%85%B8%E5%9E%8B%E7%9A%84%E5%AE%8C%E5%85%A8%E5%8F%AF%E4%BF%A1%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">01-3 典型的完全可信文件</span></a></li><li class="toc-item toc-level-3"><a href="#01-4-%E5%A4%A7%E6%A6%82%E7%8E%87%E5%8F%AF%E4%BF%A1%E7%9A%84%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">01-4 大概率可信的文件</span></a></li><li class="toc-item toc-level-3"><a href="#01-5-%E6%9C%89%E7%96%91%E7%82%B9%E4%BD%86%E6%98%AF%E4%B9%9F%E8%AE%B8%E5%8F%AF%E4%BF%A1%E7%9A%84%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">01-5 有疑点但是也许可信的文件</span></a></li><li class="toc-item toc-level-3"><a href="#01-6-%E6%AD%A3%E5%84%BF%E5%85%AB%E7%BB%8F%E7%9A%84%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F" class="toc-link"><span class="toc-text">01-6 正儿八经的恶意程序</span></a></li></ol></li></ol></div></article><article class="card card-content categories-widget"><div class="categories-card"><div class="categories-header"><i class="iconfont icon-fenlei" style="padding-right:2px"></i>分类</div><div class="categories-list"><a href="/categories/%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/"><div class="categories-list-item">开发笔记 <span class="categories-list-item-badge">1</span></div></a><a href="/categories/%E7%A7%91%E6%99%AE/"><div class="categories-list-item">科普 <span class="categories-list-item-badge">2</span></div></a><a href="/categories/%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/"><div class="categories-list-item">折腾记录 <span class="categories-list-item-badge">2</span></div></a></div></div></article><article class="card card-content tags-widget"><div class="tags-card"><div class="tags-header"><i class="iconfont icon-biaoqian" style="padding-right:2px"></i>热门标签</div><div class="tags-list"><a href="/tags/%E7%A7%91%E6%99%AE/" title="科普"><div class="tags-list-item">科普</div></a><a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" title="信息安全"><div class="tags-list-item">信息安全</div></a><a href="/tags/Minecraft/" title="Minecraft"><div class="tags-list-item">Minecraft</div></a><a href="/tags/%E5%AE%89%E5%8D%93/" title="安卓"><div class="tags-list-item">安卓</div></a><a href="/tags/CSharp/" title="CSharp"><div class="tags-list-item">CSharp</div></a></div></div></article></div></aside><main class="main-column"><article class="card card-content"><header><h1 class="post-title">一些网络安全方面的基础科普 - P1 识别恶意软件</h1></header><div class="post-meta post-show-meta"><time datetime="2022-11-20T21:38:10.000Z"><i class="iconfont icon-calendar" style="margin-right:2px"></i> <span>2022-11-21</span> </time><span class="dot"></span> <a href="/categories/%E7%A7%91%E6%99%AE/" class="post-meta-link">科普 </a><span class="dot"></span> <span>3.2k 字</span></div><div class="post-meta post-show-meta" style="margin-top:-10px"><div style="display:flex;align-items:center"><i class="iconfont icon-biaoqian" style="margin-right:2px;font-size:1.15rem"></i> <a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" class="post-meta-link">信息安全 </a><span class="dot"></span> <a href="/tags/%E7%A7%91%E6%99%AE/" class="post-meta-link">科普</a></div></div><div class="post-content" id="section"><p>这几天看到了一些比较肆虐而且比较常见的互联网病毒传播，所以专门写篇文章聊一聊这个问题</p><p>特别一提，由于本文的性质，本文章为公共领域文章，即在世界范围内放弃本文的所有权利，故任何人都可以以任何方式转载或重新发布</p><p>当然，如果你可以保留指向本文章的链接那就再好不过了，因为本文章可能会更新，保留链接可以使读者获得及时的更新</p><p><strong>本文章虽然是面向Windows的，但是安卓或者其他平台举一反三也可以用，本文章的方案只是个人经验，常在河边走总会踩进去！</strong></p><h2 id="01-手把手的入门-浅谈一下比较泛用的病毒-恶意软件-识别方式"><a href="#01-手把手的入门-浅谈一下比较泛用的病毒-恶意软件-识别方式" class="headerlink" title="01 手把手的入门! 浅谈一下比较泛用的病毒(恶意软件)识别方式"></a>01 手把手的入门! 浅谈一下比较泛用的病毒(恶意软件)识别方式</h2><h3 id="01-1-万事开头难-误报"><a href="#01-1-万事开头难-误报" class="headerlink" title="01-1 万事开头难: 误报"></a>01-1 万事开头难: 误报</h3><p>对于对信息安全方面不太熟悉的朋友来说，有一个词很熟悉: <strong>误报</strong></p><p>误报这个问题具体来说就是因为某些软件(外挂, 破解器)的行为和病毒实在是太像了，导致杀毒软件不能准确的识别</p><p>于是有些病毒作者就把思路打开了: <em><strong>如果杀毒软件会把病毒和破解工具搞混，那是不是可以把他们捆绑在一起让用户手动放行呢？</strong></em></p><p>没错，是这样的，并且有很大一部分的病毒也正是这样传播的，所以，<em><strong>支持正版，不要开挂</strong></em>是预防病毒很好的手段</p><p>哎哎别关网页，肯定有人要说了: “你这说了个JB”，别慌，接下来是正题</p><p><strong>看之前请记住，以下的分析并不能替代杀毒软件的动态监测</strong></p><p><strong>也请不要抱着: 我也没啥值钱的东西感染就感染了呗</strong></p><p><strong>现代的木马盗号已经是轻的了，冒充你的信息贷款，使用你的电脑攻击其他设备或者进行其他违法行为才是需要警惕的，毕竟警察看到的是从你的设备发出的攻击</strong></p><h3 id="01-2-Virus-Total-简单，高效的恶意文件分析识别网站"><a href="#01-2-Virus-Total-简单，高效的恶意文件分析识别网站" class="headerlink" title="01-2 Virus Total: 简单，高效的恶意文件分析识别网站"></a>01-2 Virus Total: 简单，高效的恶意文件分析识别网站</h3><p>接下来，就是我们的正题: <strong>如何将外挂等工具与木马病毒区分开来</strong></p><p>当然，如果你是卡巴斯基用户…只需要右键一下…</p><p><img alt="image-20221121074133901" class="lozad post-image" src="/image/image-20221121074133901.png" data-src="/image/image-20221121074133901.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>咳咳，跑题了，先放链接: <a href="https://www.virustotal.com/gui/home/upload" rel="noopener" target="_blank">Virus Total</a></p><p>打开上面的链接，你会看到这样的页面</p><p><img alt="image-20221121060717496" class="lozad post-image" src="/image/image-20221121055646500.png" data-src="/image/image-20221121055646500.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>OK, 这就是我们的主角了，具体它是什么网站感兴趣的可以自行查询</p><p>主页很简单，点击 <strong>Choose file</strong> 按钮或者将文件拖拽到中间的图标上[参考下图]即可上传文件进行分析</p><p><img alt="image-20221121060717496" class="lozad post-image" src="/image/image-20221121060717496.png" data-src="/image/image-20221121060717496.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>拖拽上去之后，如果你的文件从来没有人上传过，会弹出一个窗口要求你确认上传[参考下图]，点击中间的 <strong>Confirm upload</strong> 按钮即可上传。 请注意，<strong>你所上传的文件，对于专业的安全研究人员来说，是可以下载的，请不要上传涉及机密以及个人隐私的文件</strong></p><p><img alt="image-20221121061919925" class="lozad post-image" src="/image/image-20221121061919925.png" data-src="/image/image-20221121061919925.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>新的文件可能需要一些时间来扫描，等扫描结束之后，我们即可看到结果页面，大概长下面这样</p><p><img alt="image-20221121062540403" class="lozad post-image" src="/image/image-20221121062540403.png" data-src="/image/image-20221121062540403.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>首先，最主要的部分就是文件安全概览部分，也就是下图中的部分</p><p><img alt="image-20221121063046747" class="lozad post-image" src="/image/image-20221121063046747.png" data-src="/image/image-20221121063046747.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p><strong>左边的圆环 [图中标有 1 的方框]</strong> 代表着有多少杀毒软件认为这个文件是带有恶意的，在这张图中，总共有70个杀毒软件对文件进行了扫描，其中有0个杀毒软件将其汇报为恶意</p><p><strong>圆环的下方 [图中标有 2 的方框]</strong> 代表有多少VT的用户认为这个文件是恶意或者善意的，图中只有我自己投了一票，所以上面的评分是问号。<strong>这个评分是个人就能投，目前对于恶意刷票是否有惩罚我没有了解，所以它并不能权威的表示这个文件具体的行为，但是具有一定的参考价值</strong></p><p><strong>在整体靠右的位置 [图中标有 3 的方框]<strong>，代表这个文件第一次上传是什么时候，可以看到我选择的文件在五天前第一次被上传，</strong>通常来说，较旧的文件(大于半年)的结果是比较准确的，因为不明确的文件大概率都被各大安全公司已经拖回去手动分析过了，而较新的文件可能存在漏检的问题，因为病毒也会尝试新的技术来躲避杀毒软件的追踪</strong></p><p>继续向下看，就可以看到几个分页 [见下图]，点击任意标题即可跳转到对应的页，四个标签分别对应着 **杀毒软件检测结果 [图中标有1的方框]<strong>，</strong>文件详情 [图中标有2的方框]<strong>，</strong>该文件的行为(就是他执行之后干了啥) [图中标有3的方框]<strong>，</strong>社区评分的详情 [图中标有4的方框，对应上一张图的2号框]**，</p><p><img alt="image-20221121064229727" class="lozad post-image" src="/image/image-20221121064229727.png" data-src="/image/image-20221121064229727.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>其中，我们在 <strong>杀毒软件检测结果</strong> 页中，主要关注 <strong>如果杀毒软件报毒，那么杀毒软件认为他是个什么东西，即下图中红色字体的部分</strong> (下图中，为了演示我换了一个报毒的样本)</p><p><img alt="image-20221121065913636" class="lozad post-image" src="/image/image-20221121065913636.png" data-src="/image/image-20221121065913636.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>而另外几个标签页，则会结合杀毒软件检测结果中的信息综合使用，详见下文</p><p>在接下来的文章中，我会选择四类文件进行分析，分别是 <strong>完全可信的文件</strong>, <strong>大概率可信的文件</strong>, <strong>有疑点但是也许可信的文件</strong>, <strong>大概率不可信的文件</strong>，并向大家指出如何区分它们.</p><h3 id="01-3-典型的完全可信文件"><a href="#01-3-典型的完全可信文件" class="headerlink" title="01-3 典型的完全可信文件"></a>01-3 典型的完全可信文件</h3><p>这一部分最为简单，一个典型的白名单文件应该做到什么呢？代码透明，没有恶意行为，有可信任的文件发布者，满足这点即可放心的使用</p><p>在这里，我使用了自己的 EV 证书签名了一个来自 Google Android Platform Tools 的文件，并将其上传至 Virus Total，<a href="https://www.virustotal.com/gui/file/660de8659567171bf0089279ab7feea64f50e381132d6c2d31fe0c5a0032551d/details" rel="noopener" target="_blank">可以点击这个链接</a> 查看</p><p>对于这个文件，72个杀毒软件对其进行了测试，其中有0个杀毒软件将其标记为了病毒</p><p>同时我们点击文件详情(忘了在哪里？回去看看吧 XD)， 向下拖，可以看到有一个叫做签名信息的区域，其中有一行带有绿色对勾的 <strong>Signed file, valid signature</strong> , 表明该文件经过了数字签名(什么是数字签名? <a href="https://zhuanlan.zhihu.com/p/354439233" rel="noopener" target="_blank">点这里</a> 或者 <a href="https://ruanyifeng.com/blog/2011/08/what_is_a_digital_signature.html" rel="noopener" target="_blank">点这里</a> 查看科普)，同时该文件的签名人持有的是EV证书(什么是EV证书? <a href="https://www.wosign.com/Products/digicert_CodeSigning_EV.htm" rel="noopener" target="_blank">点这里查看科普</a>) 所以该文件大概率是可信的. [见下图]</p><p><img alt="image-20221121071645358" class="lozad post-image" src="/image/image-20221121071645358.png" data-src="/image/image-20221121071645358.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><h3 id="01-4-大概率可信的文件"><a href="#01-4-大概率可信的文件" class="headerlink" title="01-4 大概率可信的文件"></a>01-4 大概率可信的文件</h3><p>这里我们选择了一个来自 Github 的文件，其报告可以从 <a href="https://www.virustotal.com/gui/file/7f345f2c2f188e9a31b14474bd52e4b68bd2df67a6da3eb0ab3f4ccb3e26276f/behavior" rel="noopener" target="_blank">这里</a> 查看，大部分情况下，我们使用的一些小工具并没有进行数字签名(贵啊!)，不过相对来说，还是比较好区分的</p><p>首先，没有任何杀毒软件对其报毒，这很好，其次，虽然它没有签名，但是他也没有任何的异常行为(见下图红框)，所以我们认为他是可信的</p><p><img alt="image-20221121081224780" class="lozad post-image" src="/image/image-20221121081224780.png" data-src="/image/image-20221121081224780.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><h3 id="01-5-有疑点但是也许可信的文件"><a href="#01-5-有疑点但是也许可信的文件" class="headerlink" title="01-5 有疑点但是也许可信的文件"></a>01-5 有疑点但是也许可信的文件</h3><p>接下来，也就是本文的重点难点，<strong>怎么样区分误报和真正的恶意软件</strong></p><p>在阅读以下文本之前，强烈建议你先看看 <strong><a href="https://encyclopedia.kaspersky.com/knowledge/who-creates-malware-and-why/" rel="noopener" target="_blank">来自卡巴斯基的恶意软件科普及命名简介</a></strong></p><p>首先，先回顾一个问题: <strong>为什么会有误报发生?</strong> 是因为<strong>某些软件(外挂, 破解器)的行为和病毒实在是太像了，导致杀毒软件不能准确的识别</strong></p><p>另一个方面，误报<strong>通常发生在用户使用量较小的杀毒软件上</strong>，这很好理解，因为用户量大的杀毒软件通常都针对误报做了足够好的优化，一般我认为在 <strong>ESET-NOD32</strong>, <strong>Avast</strong>, <strong>Comodo</strong>, <strong>BitDefender</strong>, <em><strong>Kaspersky</strong></em>, <em><strong>Symantec</strong></em>，<strong>Microsoft</strong>, <strong>Rising</strong>, <strong>Tencent</strong> 算是大厂，因为他们的用户量比较大</p><p>最后，<strong>误报通常都 <em>不</em> 会显示出有意义的病毒种类信息</strong>，因为杀毒软件只是因为不认识或者怀疑而报毒，而并不是因为识别出了具体的行为</p><p>拿风灵月影 <a href="https://www.virustotal.com/gui/file/057d88f7267e2996447eb41bd4d1f2320df30535e7f0bb2023b11281e98dcd11" rel="noopener" target="_blank">举个例子</a></p><p><img alt="image-20221121175252340" class="lozad post-image" src="/image/image-20221121175252340.png" data-src="/image/image-20221121175252340.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>虽然有22个杀毒软件认为他不是好东西，但是大家都基本可以认出来他是 <strong>GameHack</strong>, <strong>3DMGAME Trainer</strong>, 而上面的大厂列表中，最严重的是 <strong>Comodo</strong> 的 <strong>ApplicUnwnt</strong> ， 也就是说本身不是恶意， 也许只是对你没有啥用的软件，所以虽然他看起来很多报毒，但是实际上并没有啥大问题</p><hr><p>再换个例子，<a href="https://www.virustotal.com/gui/file/edad8bb0b355e62517ba8e8f4ea8e554db54ac23485925615ff6bbbc93527319" rel="noopener" target="_blank">另外一款游戏修改器</a></p><p><img alt="image-20221121175921201" class="lozad post-image" src="/image/image-20221121175921201.png" data-src="/image/image-20221121175921201.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>只有四款杀毒软件认为其有恶意，其中 <strong>Symantec</strong> 的报毒原因是来源于机器学习 … 总之，IDS也没有啥严重的规则命中，我们也基本可以信任它。</p><hr><p>接下来我们上点难度，用非外挂软件 <a href="https://www.virustotal.com/gui/file/c9673b2c396ed730d8b0f430666e863fad8cd1130bf73ec168d557df9bb15ce2" rel="noopener" target="_blank">举个例子</a> , 这个链接中的样本有 9 &#x2F; 67 的杀毒软件认为他是病毒</p><p><img alt="image-20221121150827935" class="lozad post-image" src="/image/image-20221121150827935.png" data-src="/image/image-20221121150827935.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>我们先看，其中有三款杀毒软件将文件简单的将文件标为 <strong>Malicious（恶意）</strong>，针对这个结果，我们等下看</p><p>有三款杀毒软件明确的告诉我们，他们只是怀疑这个程序，分别是 <strong>ESET-NOD32</strong> 的 <strong>A Variant Of Win64&#x2F;Packed.VMProtect.J Suspicious（使用了加壳工具VMProtect的可疑程序）</strong>，<strong>SentinelOne (Static ML)</strong> 的 <strong>Static AI - Suspicious PE （可疑的PE文件）</strong>，<strong>Sophos</strong> 的 <strong>Generic ML PUA (PUA) （PUA: 不需要的软件，也许是垃圾软件）</strong></p><p>当然了，有的朋友肯定要说了，你知道他们代表的是啥，我又不知道啊！首先，我们可以尝试搜索 <strong>报毒的杀毒软件名 &lt;空格&gt; 汇报的病毒名称</strong>，例如我们搜索 <strong>Sophos Generic ML PUA (PUA)</strong> 搜索引擎会给我们以下的结果</p><p><img alt="image-20221121153456704" class="lozad post-image" src="/image/image-20221121153456704.png" data-src="/image/image-20221121153456704.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>这次很幸运，头两个结果将会把我们带到杀毒软件的官方文档，<a href="https://support.sophos.com/support/s/article/KB-000036922?language=en_US" rel="noopener" target="_blank">点击进去</a> 会看到杀毒软件将其描述为 <strong>潜在有害应用程序 （PUA） 是一个术语，用于描述虽然不是恶意的，但通常被认为不适合业务网络的应用程序</strong>，也就是说通常不包含恶意</p><p>而 <strong>SentinelOne</strong> 的汇报则简单明了，直接说明了是可疑的文件，我们先跳过不管</p><p><strong>ESET-NOD32</strong> 的情况则稍微有一些复杂，我们的搜索结果大概长这样</p><p><img alt="image-20221121154204253" class="lozad post-image" src="/image/image-20221121154204253.png" data-src="/image/image-20221121154204253.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>我们通过阅读开始的几篇文章 <strong>不是卖软件</strong> 的文章即可了解并推断，这种误报是相当常见的</p><p>接下来，我们继续查看最后的几款杀毒软件，在互联网上搜索，发现针对 <strong>Trojan.Malware.300983.susgen</strong> 的反馈大多是误报，<strong>Trojan.Heur!.02292022</strong> 几乎没有有用的信息，<strong>Generic.mg.6a3cf94332d7fa61</strong> 更是几乎没有关联的网页</p><p>最后我们看看大厂，在 <strong>ESET-NOD32</strong>, <strong>Avast</strong>, <strong>Comodo</strong>, <strong>BitDefender</strong>, <em><strong>Kaspersky</strong></em>, <strong>Microsoft</strong>, <strong>Rising</strong>, <strong>Tencent</strong> 中，只有一家汇报了风险，而且是怀疑，所以这个文件大概率没有问题</p><hr><p>总结一下，如果大家都认为一个样本属于 <strong>GameHack</strong>, <strong>PUA</strong>, <strong>HACKTOOL</strong> 之类的标签，那么他大概率是没啥问题的，如果一些软件为了防止破解加了很重的保护，那么大概率也是误报，最终可以依据 <strong>ESET-NOD32</strong>, <strong>Avast</strong>, <strong>Comodo</strong>, <strong>BitDefender</strong>, <em><strong>Kaspersky</strong></em>, <em><strong>Symantec</strong></em>，<strong>Microsoft</strong>, <strong>Rising</strong>, <strong>Tencent</strong> 的报告做出决定，如果他们都觉得没啥事，那大概率是误报，但是如果他们中有 <strong>两个及以上</strong> 认为这个程序有害，那大概率就是真的有问题</p><h3 id="01-6-正儿八经的恶意程序"><a href="#01-6-正儿八经的恶意程序" class="headerlink" title="01-6 正儿八经的恶意程序"></a>01-6 正儿八经的恶意程序</h3><p>接下来我给大家看看正经的恶意程序长啥样</p><p><a href="https://www.virustotal.com/gui/file/e9a3ad87d41224218c4472c812b7c095edfec6b48f7cd5d87c52bdc50678e113" rel="noopener" target="_blank">安卓偷照片的勒索病毒</a></p><p><img alt="image-20221121181731669" class="lozad post-image" src="/image/image-20221121181731669.png" data-src="/image/image-20221121181731669.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p><strong>Kaspersky</strong>, <strong>ESET-NOD32</strong>, <strong>Avast</strong>，<strong>BitDefender</strong> 均准确的识别出这是 <strong>Spy Trojan（窃取信息的木马）</strong></p><p>Windows<a href="https://www.virustotal.com/gui/file/be2e8a3557c637707ff81d92c181c2cbfe84ac9c21d1ef8afdf9ec1d2b49b957" rel="noopener" target="_blank">下面的远程控制木马</a></p><p><img alt="image-20221121182052440" class="lozad post-image" src="/image/image-20221121182052440.png" data-src="/image/image-20221121182052440.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E"></p><p>这还用说？满脸都是”我是木马”</p><hr><p>总之，基本<strong>卡巴斯基（Kaspersky）</strong>报毒，他就真的是毒，所以卡巴红了就…别用了</p><hr><p>本篇到这里就写完了，下一篇教大家，如果真的很想用，那么应该怎么搭建一个安全的环境</p><p>我很少写这样基础向的文章，如果有什么问题可以联系我，例如推特 @VeroFess</p><p>下次见！</p></div><div><div class="copyright note-info post-note" style="margin-top:42px"><p><span style="font-weight:700">作者：</span><a href="/about" rel="nofollow noopener noreferrer" target="_blank"> VeroFess</a></p><p><span style="font-weight:700">文章链接：</span><a href="https://blog.binklac.com/d4ad30414b22/" rel="nofollow noopener noreferrer" target="_blank"> https://blog.binklac.com/d4ad30414b22/</a></p><p><span style="font-weight:700">版权声明：</span>本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank">CC BY-NC-SA 4.0 协议</a>。转载请注明出处！</p></div></div></article><div class="nav"><div class="nav-item-prev"><a href="/2f586df9bdee/" class="nav-link"><i class="iconfont icon-left nav-prev-icon"></i><div><div class="nav-label">上一篇</div><div class="nav-title">强制让小米AOD只能亮五分钟的机型保持AOD常亮</div></div></a></div><div class="nav-item-next"><a href="/f72f727a78aa/" class="nav-link"><div><div class="nav-label">下一篇</div><div class="nav-title">CSharp中实现一个可继承的Singleton基类</div></div><i class="iconfont icon-right nav-next-icon"></i></a></div></div><div class="card card-content comment-card" style="margin-top:16px"><div class="comment-card-title">评论</div><div id="gitalk-container"></div><link href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" rel="stylesheet"><script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><script src="/js/lib/md5.min.js"></script><script>var gitalk=new Gitalk({clientID:"fa33b26af65fe0341b72",clientSecret:"f01690161815f547af7bef238cd1928e5a2744b5",repo:"GitTalkStorage",owner:"VeroFess",admin:["VeroFess"],id:md5(location.href),distractionFreeMode:!1,language:"zh-CN",labels:["Gitalk"],perPage:10});gitalk.render("gitalk-container")</script></div><div class="card card-content toc-card" id="mobiletoc"><div class="toc-header"><i class="iconfont icon-menu" style="padding-right:2px"></i>目录</div><ol class="toc"><li class="toc-item toc-level-2"><a href="#01-%E6%89%8B%E6%8A%8A%E6%89%8B%E7%9A%84%E5%85%A5%E9%97%A8-%E6%B5%85%E8%B0%88%E4%B8%80%E4%B8%8B%E6%AF%94%E8%BE%83%E6%B3%9B%E7%94%A8%E7%9A%84%E7%97%85%E6%AF%92-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6-%E8%AF%86%E5%88%AB%E6%96%B9%E5%BC%8F" class="toc-link"><span class="toc-text">01 手把手的入门! 浅谈一下比较泛用的病毒(恶意软件)识别方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#01-1-%E4%B8%87%E4%BA%8B%E5%BC%80%E5%A4%B4%E9%9A%BE-%E8%AF%AF%E6%8A%A5" class="toc-link"><span class="toc-text">01-1 万事开头难: 误报</span></a></li><li class="toc-item toc-level-3"><a href="#01-2-Virus-Total-%E7%AE%80%E5%8D%95%EF%BC%8C%E9%AB%98%E6%95%88%E7%9A%84%E6%81%B6%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90%E8%AF%86%E5%88%AB%E7%BD%91%E7%AB%99" class="toc-link"><span class="toc-text">01-2 Virus Total: 简单，高效的恶意文件分析识别网站</span></a></li><li class="toc-item toc-level-3"><a href="#01-3-%E5%85%B8%E5%9E%8B%E7%9A%84%E5%AE%8C%E5%85%A8%E5%8F%AF%E4%BF%A1%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">01-3 典型的完全可信文件</span></a></li><li class="toc-item toc-level-3"><a href="#01-4-%E5%A4%A7%E6%A6%82%E7%8E%87%E5%8F%AF%E4%BF%A1%E7%9A%84%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">01-4 大概率可信的文件</span></a></li><li class="toc-item toc-level-3"><a href="#01-5-%E6%9C%89%E7%96%91%E7%82%B9%E4%BD%86%E6%98%AF%E4%B9%9F%E8%AE%B8%E5%8F%AF%E4%BF%A1%E7%9A%84%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">01-5 有疑点但是也许可信的文件</span></a></li><li class="toc-item toc-level-3"><a href="#01-6-%E6%AD%A3%E5%84%BF%E5%85%AB%E7%BB%8F%E7%9A%84%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F" class="toc-link"><span class="toc-text">01-6 正儿八经的恶意程序</span></a></li></ol></li></ol></div></main><aside class="right-column"><div class="sticky-widescreen"><article class="card card-content toc-card"><div class="toc-header"><i class="iconfont icon-menu" style="padding-right:2px"></i>目录</div><ol class="toc"><li class="toc-item toc-level-2"><a href="#01-%E6%89%8B%E6%8A%8A%E6%89%8B%E7%9A%84%E5%85%A5%E9%97%A8-%E6%B5%85%E8%B0%88%E4%B8%80%E4%B8%8B%E6%AF%94%E8%BE%83%E6%B3%9B%E7%94%A8%E7%9A%84%E7%97%85%E6%AF%92-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6-%E8%AF%86%E5%88%AB%E6%96%B9%E5%BC%8F" class="toc-link"><span class="toc-text">01 手把手的入门! 浅谈一下比较泛用的病毒(恶意软件)识别方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#01-1-%E4%B8%87%E4%BA%8B%E5%BC%80%E5%A4%B4%E9%9A%BE-%E8%AF%AF%E6%8A%A5" class="toc-link"><span class="toc-text">01-1 万事开头难: 误报</span></a></li><li class="toc-item toc-level-3"><a href="#01-2-Virus-Total-%E7%AE%80%E5%8D%95%EF%BC%8C%E9%AB%98%E6%95%88%E7%9A%84%E6%81%B6%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90%E8%AF%86%E5%88%AB%E7%BD%91%E7%AB%99" class="toc-link"><span class="toc-text">01-2 Virus Total: 简单，高效的恶意文件分析识别网站</span></a></li><li class="toc-item toc-level-3"><a href="#01-3-%E5%85%B8%E5%9E%8B%E7%9A%84%E5%AE%8C%E5%85%A8%E5%8F%AF%E4%BF%A1%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">01-3 典型的完全可信文件</span></a></li><li class="toc-item toc-level-3"><a href="#01-4-%E5%A4%A7%E6%A6%82%E7%8E%87%E5%8F%AF%E4%BF%A1%E7%9A%84%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">01-4 大概率可信的文件</span></a></li><li class="toc-item toc-level-3"><a href="#01-5-%E6%9C%89%E7%96%91%E7%82%B9%E4%BD%86%E6%98%AF%E4%B9%9F%E8%AE%B8%E5%8F%AF%E4%BF%A1%E7%9A%84%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">01-5 有疑点但是也许可信的文件</span></a></li><li class="toc-item toc-level-3"><a href="#01-6-%E6%AD%A3%E5%84%BF%E5%85%AB%E7%BB%8F%E7%9A%84%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F" class="toc-link"><span class="toc-text">01-6 正儿八经的恶意程序</span></a></li></ol></li></ol></article><article class="card card-content"><div class="recent-posts-card"><div class="recent-posts-header"><i class="iconfont icon-wenzhang_huaban" style="padding-right:2px"></i>最近文章</div><div class="recent-posts-list"><div class="recent-posts-item"><div class="recent-posts-item-title">2022-11-22</div><a href="/27113fa2a38a/"><div class="recent-posts-item-content">一些网络安全方面的基础科普 - P2 操作系统安全从入门到放弃</div></a></div><div class="recent-posts-item"><div class="recent-posts-item-title">2022-11-22</div><a href="/2f586df9bdee/"><div class="recent-posts-item-content">强制让小米AOD只能亮五分钟的机型保持AOD常亮</div></a></div><div class="recent-posts-item"><div class="recent-posts-item-title">2022-11-21</div><a href="/d4ad30414b22/"><div class="recent-posts-item-content">一些网络安全方面的基础科普 - P1 识别恶意软件</div></a></div><div class="recent-posts-item"><div class="recent-posts-item-title">2022-06-09</div><a href="/f72f727a78aa/"><div class="recent-posts-item-content">CSharp中实现一个可继承的Singleton基类</div></a></div></div></div></article></div></aside></div></div></div></div><footer class="footer"><div class="footer-container"><div><div class="footer-dsc"><span>Copyright © 2017 - 2022 </span>&nbsp; <a href="/" class="footer-link">0xBACB</a></div></div><div class="footer-dsc">Powered by <a href="https://hexo.io/" class="footer-link" rel="nofollow noopener noreferrer" target="_blank">&nbsp;Hexo </a><span>&nbsp;|&nbsp;</span> Theme - <a href="https://github.com/theme-kaze" class="footer-link" rel="nofollow noopener noreferrer" target="_blank">&nbsp;Kaze</a></div><div class="footer-dsc">本站总访问量<span id="busuanzi_value_site_pv"></span>次 <span>&nbsp;|&nbsp;</span> 本站总访客数<span id="busuanzi_value_site_uv"></span>次</div></div></footer><a class="basebutton" aria-label="回到顶部" id="scrollbutton" role="button"><i class="iconfont button-icon icon-arrowleft"></i> </a><a class="basebutton" aria-label="menu button" id="menubutton" role="button"><i class="iconfont button-icon icon-menu"></i> </a><a class="basebutton" aria-label="控制中心" id="popbutton" role="button"><i class="iconfont button-icon icon-expand"></i> </a><a class="basebutton darkwidget" aria-label="夜色模式" id="darkbutton" role="button"><i class="iconfont button-icon icon-weather"></i> </a><a class="basebutton searchwidget" aria-label="搜索" id="searchbutton" role="button"><i class="iconfont button-icon icon-search"></i></a><script src="/js/main.js"></script><script>loadScript("/js/lib/busuanzi.min.js")</script><script>var addLazyload=function(){lozad(".lozad",{load:function(a){a.srcset=a.getAttribute("data-src")},loaded:function(a){a.classList.add("loaded")}}).observe()}</script><script>loadScript("/js/lib/lozad.min.js",addLazyload)</script><script src="//instant.page/5.1.0" integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw" type="module"></script><script>var googleAnalytics=function(){function a(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],a("js",new Date),a("config","G-YYWB3PMXXN")}</script><script>loadScript("https://www.googletagmanager.com/gtag/js?id=G-YYWB3PMXXN",googleAnalytics)</script><script>setTimeout(()=>{localSearch("/search.json")},0)</script></body></html>